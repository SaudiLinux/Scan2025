#!/usr/bin/env python3
# -*- coding: utf-8 -*-
"""
Israeli Domain Vulnerability Analyzer
Ø£Ø¯Ø§Ø© ØªØ­Ù„ÙŠÙ„ ÙˆØ¹Ø±Ø¶ Ø§Ù„Ø«ØºØ±Ø§Øª Ø§Ù„Ø£Ù…Ù†ÙŠØ© Ù„Ù„Ø¯ÙˆÙ…ÙŠÙ†Ø§Øª Ø§Ù„Ø¥Ø³Ø±Ø§Ø¦ÙŠÙ„ÙŠØ©
"""

import json
import sys
from datetime import datetime
from colorama import Fore, Style, init

# Initialize colorama
init(autoreset=True)

class VulnerabilityAnalyzer:
    def __init__(self):
        self.severity_colors = {
            'Critical': Fore.RED + Style.BRIGHT,
            'High': Fore.RED,
            'Medium': Fore.YELLOW,
            'Low': Fore.GREEN,
            'Info': Fore.CYAN
        }
        
        self.vulnerability_types = {
            'SQL Injection': {'severity': 'Critical', 'description': 'Ø­Ù‚Ù† Ø£ÙˆØ§Ù…Ø± SQL ÙÙŠ Ù‚Ø§Ø¹Ø¯Ø© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª'},
            'Cross-Site Scripting (XSS)': {'severity': 'High', 'description': 'ØªÙ†ÙÙŠØ° Ø£ÙƒÙˆØ§Ø¯ JavaScript Ø®Ø¨ÙŠØ«Ø©'},
            'Local File Inclusion (LFI)': {'severity': 'High', 'description': 'ØªØ¶Ù…ÙŠÙ† Ù…Ù„ÙØ§Øª Ù…Ø­Ù„ÙŠØ© ØºÙŠØ± Ù…ØµØ±Ø­ Ø¨Ù‡Ø§'},
            'Command Injection': {'severity': 'Critical', 'description': 'Ø­Ù‚Ù† Ø£ÙˆØ§Ù…Ø± Ù†Ø¸Ø§Ù… Ø§Ù„ØªØ´ØºÙŠÙ„'},
            'Server-Side Request Forgery (SSRF)': {'severity': 'High', 'description': 'ØªØ²ÙŠÙŠÙ Ø·Ù„Ø¨Ø§Øª Ù…Ù† Ø§Ù„Ø®Ø§Ø¯Ù…'},
            'Directory Traversal': {'severity': 'Medium', 'description': 'Ø§Ù„ÙˆØµÙˆÙ„ Ø¥Ù„Ù‰ directories ØºÙŠØ± Ù…ØµØ±Ø­ Ø¨Ù‡Ø§'},
            'SSL/TLS Issues': {'severity': 'Medium', 'description': 'Ù…Ø´Ø§ÙƒÙ„ ÙÙŠ ØªØ´ÙÙŠØ± SSL/TLS'},
            'Information Disclosure': {'severity': 'Low', 'description': 'ÙƒØ´Ù Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø­Ø³Ø§Ø³Ø©'},
            'Default Credentials': {'severity': 'High', 'description': 'Ø§Ø³ØªØ®Ø¯Ø§Ù… ÙƒÙ„Ù…Ø§Øª Ù…Ø±ÙˆØ± Ø§ÙØªØ±Ø§Ø¶ÙŠØ©'},
            'Weak Authentication': {'severity': 'Medium', 'description': 'Ø¶Ø¹Ù ÙÙŠ Ø¢Ù„ÙŠØ§Øª Ø§Ù„Ù…ØµØ§Ø¯Ù‚Ø©'}
        }
    
    def print_banner(self):
        """Print the analyzer banner"""
        banner = f"""
{Fore.RED}â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
â•‘              Israeli Domain Vulnerability Analyzer                    â•‘
â•‘                    Ù…Ø­Ù„Ù„ Ø§Ù„Ø«ØºØ±Ø§Øª Ø§Ù„Ø£Ù…Ù†ÙŠØ© Ø§Ù„Ø¥Ø³Ø±Ø§Ø¦ÙŠÙ„ÙŠØ©                â•‘
â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•{Style.RESET_ALL}
{Fore.CYAN}By: ğ™ƒğ™–ğ™˜ğ™ ğ™ğ™£ğ™œ ğ™ğ™šğ™˜ğ™ğ™£ğ™¤ğ™¡ğ™¤ğ™œğ™® ğŸ‡µğŸ‡¸{Style.RESET_ALL}
        """
        print(banner)
    
    def load_scan_results(self, filename):
        """Load scan results from JSON file"""
        try:
            with open(filename, 'r', encoding='utf-8') as file:
                return json.load(file)
        except FileNotFoundError:
            print(f"{Fore.RED}[-] File not found: {filename}{Style.RESET_ALL}")
            return None
        except json.JSONDecodeError:
            print(f"{Fore.RED}[-] Invalid JSON format in: {filename}{Style.RESET_ALL}")
            return None
    
    def analyze_vulnerabilities(self, scan_data):
        """Analyze vulnerabilities and extract detailed information"""
        if not scan_data or 'vulnerabilities' not in scan_data:
            print(f"{Fore.YELLOW}[!] No vulnerability data found{Style.RESET_ALL}")
            return []
        
        vulnerabilities = scan_data['vulnerabilities']
        analyzed_vulns = []
        
        for vuln in vulnerabilities:
            if isinstance(vuln, dict):
                vuln_info = {
                    'type': vuln.get('type', 'Unknown'),
                    'severity': vuln.get('severity', 'Unknown'),
                    'url': vuln.get('url', 'Unknown'),
                    'parameter': vuln.get('parameter', 'Unknown'),
                    'payload': vuln.get('payload', 'Unknown'),
                    'description': vuln.get('description', 'No description'),
                    'proof': vuln.get('proof', 'No proof provided'),
                    'domain': vuln.get('domain', 'Unknown')
                }
                analyzed_vulns.append(vuln_info)
            else:
                # Handle simple string format
                vuln_info = {
                    'type': 'Unknown',
                    'severity': 'Unknown',
                    'url': 'Unknown',
                    'parameter': 'Unknown',
                    'payload': str(vuln),
                    'description': 'No detailed description available',
                    'proof': str(vuln),
                    'domain': 'Unknown'
                }
                analyzed_vulns.append(vuln_info)
        
        return analyzed_vulns
    
    def display_vulnerability_summary(self, vulnerabilities):
        """Display vulnerability summary statistics"""
        if not vulnerabilities:
            print(f"{Fore.GREEN}[+] No vulnerabilities found{Style.RESET_ALL}")
            return
        
        # Count vulnerabilities by severity
        severity_counts = {}
        type_counts = {}
        
        for vuln in vulnerabilities:
            severity = vuln.get('severity', 'Unknown')
            vuln_type = vuln.get('type', 'Unknown')
            
            severity_counts[severity] = severity_counts.get(severity, 0) + 1
            type_counts[vuln_type] = type_counts.get(vuln_type, 0) + 1
        
        print(f"\n{Fore.BLUE}{'='*60}{Style.RESET_ALL}")
        print(f"{Fore.CYAN}[+] VULNERABILITY SUMMARY{Style.RESET_ALL}")
        print(f"{Fore.BLUE}{'='*60}{Style.RESET_ALL}")
        
        print(f"\n{Fore.YELLOW}[+] By Severity:{Style.RESET_ALL}")
        for severity, count in sorted(severity_counts.items()):
            color = self.severity_colors.get(severity, Fore.WHITE)
            print(f"  {color}â¤ {severity}: {count} vulnerabilities{Style.RESET_ALL}")
        
        print(f"\n{Fore.YELLOW}[+] By Type:{Style.RESET_ALL}")
        for vuln_type, count in sorted(type_counts.items()):
            print(f"  â¤ {vuln_type}: {count} vulnerabilities")
        
        print(f"\n{Fore.BLUE}{'='*60}{Style.RESET_ALL}")
        print(f"{Fore.CYAN}[+] TOTAL VULNERABILITIES: {len(vulnerabilities)}{Style.RESET_ALL}")
        print(f"{Fore.BLUE}{'='*60}{Style.RESET_ALL}")
    
    def display_detailed_vulnerabilities(self, vulnerabilities):
        """Display detailed vulnerability information"""
        if not vulnerabilities:
            return
        
        print(f"\n{Fore.RED}{'='*80}{Style.RESET_ALL}")
        print(f"{Fore.RED}{' '*30}DETAILED VULNERABILITY ANALYSIS{' '*30}{Style.RESET_ALL}")
        print(f"{Fore.RED}{'='*80}{Style.RESET_ALL}")
        
        # Sort by severity (Critical first)
        severity_order = {'Critical': 1, 'High': 2, 'Medium': 3, 'Low': 4, 'Info': 5, 'Unknown': 6}
        vulnerabilities.sort(key=lambda x: severity_order.get(x.get('severity', 'Unknown'), 6))
        
        for i, vuln in enumerate(vulnerabilities, 1):
            severity = vuln.get('severity', 'Unknown')
            vuln_type = vuln.get('type', 'Unknown')
            url = vuln.get('url', 'Unknown')
            parameter = vuln.get('parameter', 'Unknown')
            payload = vuln.get('payload', 'Unknown')
            description = vuln.get('description', 'No description')
            proof = vuln.get('proof', 'No proof')
            domain = vuln.get('domain', 'Unknown')
            
            color = self.severity_colors.get(severity, Fore.WHITE)
            
            print(f"\n{Fore.RED}{'-'*60}{Style.RESET_ALL}")
            print(f"{color}[{i}] {vuln_type} - SEVERITY: {severity}{Style.RESET_ALL}")
            print(f"{Fore.RED}{'-'*60}{Style.RESET_ALL}")
            
            print(f"{Fore.CYAN}Domain: {Fore.WHITE}{domain}{Style.RESET_ALL}")
            print(f"{Fore.CYAN}URL: {Fore.WHITE}{url}{Style.RESET_ALL}")
            print(f"{Fore.CYAN}Parameter: {Fore.WHITE}{parameter}{Style.RESET_ALL}")
            print(f"{Fore.CYAN}Description: {Fore.WHITE}{description}{Style.RESET_ALL}")
            
            if payload != 'Unknown' and len(str(payload)) < 200:
                print(f"{Fore.CYAN}Payload: {Fore.YELLOW}{payload}{Style.RESET_ALL}")
            
            if proof != 'No proof' and proof != 'Unknown':
                proof_text = str(proof)[:300] + "..." if len(str(proof)) > 300 else str(proof)
                print(f"{Fore.CYAN}Proof: {Fore.MAGENTA}{proof_text}{Style.RESET_ALL}")
    
    def display_recommendations(self, vulnerabilities):
        """Display security recommendations"""
        if not vulnerabilities:
            return
        
        print(f"\n{Fore.GREEN}{'='*80}{Style.RESET_ALL}")
        print(f"{Fore.GREEN}{' '*35}SECURITY RECOMMENDATIONS{' '*35}{Style.RESET_ALL}")
        print(f"{Fore.GREEN}{'='*80}{Style.RESET_ALL}")
        
        vuln_types = set(vuln.get('type', 'Unknown') for vuln in vulnerabilities)
        
        recommendations = {
            'SQL Injection': [
                "Ø§Ø³ØªØ®Ø¯Ù… Ù…Ø¹Ø§Ù…Ù„Ø§Øª Prepared Statements ÙÙŠ Ø¬Ù…ÙŠØ¹ Ø§Ø³ØªØ¹Ù„Ø§Ù…Ø§Øª SQL",
                "Ù‚Ù… Ø¨ØªÙ†Ù‚ÙŠØ© Ø¬Ù…ÙŠØ¹ Ù…Ø¯Ø®Ù„Ø§Øª Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… Ù‚Ø¨Ù„ Ù…Ø¹Ø§Ù„Ø¬ØªÙ‡Ø§",
                "Ø§Ø³ØªØ®Ø¯Ù… Stored Procedures Ø¹Ù†Ø¯ Ø§Ù„Ø¥Ù…ÙƒØ§Ù†",
                "Ù‚Ù… Ø¨ØªÙ‚ÙŠÙŠØ¯ Ø£Ø°ÙˆÙ†Ø§Øª Ù‚Ø§Ø¹Ø¯Ø© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø­Ø³Ø¨ Ø§Ù„Ø­Ø§Ø¬Ø© ÙÙ‚Ø·"
            ],
            'Cross-Site Scripting (XSS)': [
                "Ù‚Ù… Ø¨ØªÙ†Ù‚ÙŠØ© ÙˆØªØ¹Ù‚ÙŠÙ… Ø¬Ù…ÙŠØ¹ Ù…Ø¯Ø®Ù„Ø§Øª Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…",
                "Ø§Ø³ØªØ®Ø¯Ù… Content Security Policy (CSP)",
                "Ù‚Ù… Ø¨ØªØ±Ù…ÙŠØ² Ø¬Ù…ÙŠØ¹ Ø§Ù„Ù…Ø®Ø±Ø¬Ø§Øª HTML",
                "Ø§Ø³ØªØ®Ø¯Ù… Ù…ÙƒØªØ¨Ø§Øª Ù…ÙƒØ§ÙØ­Ø© XSS Ù…Ø«Ù„ OWASP Java Encoder"
            ],
            'Local File Inclusion (LFI)': [
                "Ù‚Ù… Ø¨Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ø¨ÙŠØ¶Ø§Ø¡ Ù„Ù„Ù…Ù„ÙØ§Øª Ø§Ù„Ù…Ø³Ù…ÙˆØ­ Ø¨Ù‡Ø§",
                "ØªØ¬Ù†Ø¨ Ø§Ø³ØªØ®Ø¯Ø§Ù… Ù…Ø³Ø§Ø±Ø§Øª Ø§Ù„Ù…Ù„ÙØ§Øª Ù…Ù† Ù…Ø¯Ø®Ù„Ø§Øª Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…",
                "Ø§Ø³ØªØ®Ø¯Ù… Ù…Ø¹Ø±ÙØ§Øª ÙØ±ÙŠØ¯Ø© Ø¨Ø¯Ù„Ø§Ù‹ Ù…Ù† Ø£Ø³Ù…Ø§Ø¡ Ø§Ù„Ù…Ù„ÙØ§Øª",
                "Ù‚Ù… Ø¨ØªÙ‚ÙŠÙŠØ¯ Ø£Ø°ÙˆÙ†Ø§Øª Ù†Ø¸Ø§Ù… Ø§Ù„Ù…Ù„ÙØ§Øª"
            ],
            'Command Injection': [
                "ØªØ¬Ù†Ø¨ ØªÙ†ÙÙŠØ° Ø£ÙˆØ§Ù…Ø± Ø§Ù„Ù†Ø¸Ø§Ù… Ù…Ù† Ù…Ø¯Ø®Ù„Ø§Øª Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…",
                "Ø§Ø³ØªØ®Ø¯Ù… Ø¯ÙˆØ§Ù„ Ø¢Ù…Ù†Ø© Ù…Ø«Ù„ execve() Ø¨Ø¯Ù„Ø§Ù‹ Ù…Ù† system()",
                "Ù‚Ù… Ø¨ØªÙ†Ù‚ÙŠØ© Ù…Ø¯Ø®Ù„Ø§Øª Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… Ø¨Ø´ÙƒÙ„ ØµØ§Ø±Ù…",
                "Ø§Ø³ØªØ®Ø¯Ù… Ø£Ø¯ÙˆØ§Øª Ù…ÙƒØ§ÙØ­Ø© Command Injection"
            ],
            'Server-Side Request Forgery (SSRF)': [
                "Ù‚Ù… Ø¨Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ø¨ÙŠØ¶Ø§Ø¡ Ù„Ù„Ø¹Ù†Ø§ÙˆÙŠÙ† IP ÙˆØ§Ù„Ù†Ø·Ø§Ù‚Ø§Øª Ø§Ù„Ù…Ø³Ù…ÙˆØ­ Ø¨Ù‡Ø§",
                "Ø§Ø³ØªØ®Ø¯Ù… Ø´Ø¨ÙƒØ§Øª Ù…Ù†ÙØµÙ„Ø© Ù„Ù„Ø®Ø¯Ù…Ø§Øª Ø§Ù„Ø­Ø³Ø§Ø³Ø©",
                "Ù‚Ù… Ø¨ØªØ¹Ø·ÙŠÙ„ Ø§Ù„Ù…ÙˆØ¬Ù‡Ø§Øª ÙˆØ§Ù„Ø¨Ø±ÙˆÙƒØ³ÙŠÙ‡Ø§Øª ØºÙŠØ± Ø§Ù„Ø¶Ø±ÙˆØ±ÙŠØ©",
                "Ø§Ø³ØªØ®Ø¯Ù… Ù…ØµØ§Ø¯Ù‚Ø© ØµØ§Ø±Ù…Ø© Ù„Ù„Ø®Ø¯Ù…Ø§Øª Ø§Ù„Ø¯Ø§Ø®Ù„ÙŠØ©"
            ],
            'Directory Traversal': [
                "Ù‚Ù… Ø¨ØªÙ†Ù‚ÙŠØ© Ù…Ø³Ø§Ø±Ø§Øª Ø§Ù„Ù…Ù„ÙØ§Øª Ù…Ù† Ø£ÙŠ Ù…Ø¯Ø®Ù„Ø§Øª",
                "Ø§Ø³ØªØ®Ø¯Ù… Ù…Ø³Ø§Ø±Ø§Øª Ù†Ø³Ø¨ÙŠØ© Ù…Ø­Ø¯ÙˆØ¯Ø©",
                "Ù‚Ù… Ø¨ØªÙ‚ÙŠÙŠØ¯ Ø£Ø°ÙˆÙ†Ø§Øª Ù†Ø¸Ø§Ù… Ø§Ù„Ù…Ù„ÙØ§Øª",
                "Ø§Ø³ØªØ®Ø¯Ù… chroot jail Ø¹Ù†Ø¯ Ø§Ù„Ø¥Ù…ÙƒØ§Ù†"
            ]
        }
        
        for vuln_type in vuln_types:
            if vuln_type in recommendations:
                print(f"\n{Fore.YELLOW}[+] {vuln_type}:{Style.RESET_ALL}")
                for rec in recommendations[vuln_type]:
                    print(f"  {Fore.GREEN}â¤ {rec}{Style.RESET_ALL}")
        
        # General recommendations
        print(f"\n{Fore.YELLOW}[+] General Security Recommendations:{Style.RESET_ALL}")
        general_recs = [
            "Ù‚Ù… Ø¨ØªØ­Ø¯ÙŠØ« Ø¬Ù…ÙŠØ¹ Ø§Ù„Ù…ÙƒØªØ¨Ø§Øª ÙˆØ§Ù„Ø¥Ø·Ø§Ø±Ø§Øª Ø¨Ø§Ù†ØªØ¸Ø§Ù…",
            "Ø§Ø³ØªØ®Ø¯Ù… Ø£Ø­Ø¯Ø« Ø¥ØµØ¯Ø§Ø±Ø§Øª Ø§Ù„Ø¨Ø±Ø§Ù…Ø¬",
            "Ù‚Ù… Ø¨ØªÙ†ÙÙŠØ° Ù…Ø±Ø§Ø¬Ø¹Ø§Øª Ø£Ù…Ù†ÙŠØ© Ù…Ù†ØªØ¸Ù…Ø© Ù„Ù„ÙƒÙˆØ¯",
            "Ø§Ø³ØªØ®Ø¯Ù… Ø£Ø¯ÙˆØ§Øª ÙØ­Øµ Ø§Ù„Ø£Ù…Ø§Ù† Ø§Ù„Ø£ÙˆØªÙˆÙ…Ø§ØªÙŠÙƒÙŠØ©",
            "Ù‚Ù… Ø¨ØªØ¯Ø±ÙŠØ¨ ÙØ±ÙŠÙ‚ Ø§Ù„ØªØ·ÙˆÙŠØ± Ø¹Ù„Ù‰ Ø£ÙØ¶Ù„ Ù…Ù…Ø§Ø±Ø³Ø§Øª Ø§Ù„Ø£Ù…Ø§Ù†"
        ]
        
        for rec in general_recs:
            print(f"  {Fore.GREEN}â¤ {rec}{Style.RESET_ALL}")
    
    def export_detailed_report(self, vulnerabilities, scan_info, filename=None):
        """Export detailed vulnerability report"""
        if not filename:
            timestamp = datetime.now().strftime('%Y%m%d_%H%M%S')
            filename = f"vulnerability_analysis_{timestamp}.json"
        
        report_data = {
            'scan_info': scan_info,
            'vulnerability_summary': {
                'total_vulnerabilities': len(vulnerabilities),
                'severity_breakdown': {},
                'type_breakdown': {}
            },
            'detailed_vulnerabilities': vulnerabilities,
            'recommendations': self.generate_recommendations_list(vulnerabilities)
        }
        
        # Calculate severity breakdown
        severity_counts = {}
        type_counts = {}
        
        for vuln in vulnerabilities:
            severity = vuln.get('severity', 'Unknown')
            vuln_type = vuln.get('type', 'Unknown')
            
            severity_counts[severity] = severity_counts.get(severity, 0) + 1
            type_counts[vuln_type] = type_counts.get(vuln_type, 0) + 1
        
        report_data['vulnerability_summary']['severity_breakdown'] = severity_counts
        report_data['vulnerability_summary']['type_breakdown'] = type_counts
        
        with open(filename, 'w', encoding='utf-8') as file:
            json.dump(report_data, file, indent=2, ensure_ascii=False)
        
        print(f"{Fore.GREEN}[+] Detailed report exported: {filename}{Style.RESET_ALL}")
        return filename
    
    def generate_recommendations_list(self, vulnerabilities):
        """Generate recommendations list based on found vulnerabilities"""
        if not vulnerabilities:
            return []
        
        vuln_types = set(vuln.get('type', 'Unknown') for vuln in vulnerabilities)
        recommendations = []
        
        recommendations_map = {
            'SQL Injection': "Implement parameterized queries and input validation",
            'Cross-Site Scripting (XSS)': "Sanitize all user inputs and implement CSP",
            'Local File Inclusion (LFI)': "Use whitelisting for file paths",
            'Command Injection': "Avoid system commands with user input",
            'Server-Side Request Forgery (SSRF)': "Implement IP whitelisting",
            'Directory Traversal': "Validate and sanitize file paths"
        }
        
        for vuln_type in vuln_types:
            if vuln_type in recommendations_map:
                recommendations.append(recommendations_map[vuln_type])
        
        return recommendations
    
    def run_analysis(self, input_file):
        """Run complete vulnerability analysis"""
        self.print_banner()
        
        print(f"{Fore.YELLOW}[*] Loading scan results from: {input_file}{Style.RESET_ALL}")
        scan_data = self.load_scan_results(input_file)
        
        if not scan_data:
            return
        
        print(f"{Fore.YELLOW}[*] Analyzing vulnerabilities...{Style.RESET_ALL}")
        vulnerabilities = self.analyze_vulnerabilities(scan_data)
        
        # Display summary
        self.display_vulnerability_summary(vulnerabilities)
        
        # Display detailed vulnerabilities
        self.display_detailed_vulnerabilities(vulnerabilities)
        
        # Display recommendations
        self.display_recommendations(vulnerabilities)
        
        # Export detailed report
        report_filename = self.export_detailed_report(vulnerabilities, scan_data.get('scan_info', {}))
        
        # Final summary
        print(f"\n{Fore.BLUE}{'='*80}{Style.RESET_ALL}")
        print(f"{Fore.GREEN}[+] ANALYSIS COMPLETED SUCCESSFULLY!{Style.RESET_ALL}")
        print(f"{Fore.CYAN}[+] Total vulnerabilities analyzed: {len(vulnerabilities)}{Style.RESET_ALL}")
        print(f"{Fore.CYAN}[+] Detailed report saved: {report_filename}{Style.RESET_ALL}")
        print(f"{Fore.BLUE}{'='*80}{Style.RESET_ALL}")

def main():
    if len(sys.argv) < 2:
        print(f"{Fore.RED}Usage: python vulnerability_analyzer.py <scan_results.json>{Style.RESET_ALL}")
        print(f"{Fore.YELLOW}Example: python vulnerability_analyzer.py test_report.json{Style.RESET_ALL}")
        sys.exit(1)
    
    analyzer = VulnerabilityAnalyzer()
    analyzer.run_analysis(sys.argv[1])

if __name__ == '__main__':
    main()